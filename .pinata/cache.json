{
  "timestamp": "2026-02-03T07:28:57.009Z",
  "targetDirectory": "/Users/christiancattaneo/Projects/midas-mcp",
  "score": 0,
  "grade": "F",
  "totalGaps": 38,
  "gaps": [
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/cursor.ts",
      "lineStart": 139,
      "lineEnd": 139,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "   138|   try {\n>  139|     const result = execSync(\n   140|       `sqlite3 \"${dbPath}\" \"${query}\"`,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/scope.ts",
      "lineStart": 226,
      "lineEnd": 226,
      "columnStart": 27,
      "columnEnd": 35,
      "codeSnippet": "   225|     if (firstCommit) {\n>  226|       const filesAtStart = execSync(`git ls-tree -r --name-only ${firstCommit}`, { cwd: projectPath, encoding: 'utf8' })\n   227|         .split('\\n')",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 294,
      "lineEnd": 294,
      "columnStart": 6,
      "columnEnd": 14,
      "codeSnippet": "   293|     try {\n>  294|       execSync('npm test 2>&1', { cwd: safePath, encoding: 'utf-8', timeout: 120000 });\n   295|       gates.testsPass = true;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 311,
      "lineEnd": 311,
      "columnStart": 6,
      "columnEnd": 14,
      "codeSnippet": "   310|     try {\n>  311|       execSync('npm run lint 2>&1', { cwd: safePath, encoding: 'utf-8', timeout: 30000 });\n   312|       gates.lintsPass = true;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1084,
      "lineEnd": 1084,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "  1083|   try {\n> 1084|     const branch = execSync('git branch --show-current', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1085|     ",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1091,
      "lineEnd": 1091,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "  1090|     try {\n> 1091|       lastCommit = execSync('git log -1 --format=%H', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1092|       lastCommitMessage = execSync('git log -1 --format=%s', { cwd: safePath, encoding: 'utf-8' }).trim();",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1092,
      "lineEnd": 1092,
      "columnStart": 26,
      "columnEnd": 34,
      "codeSnippet": "  1091|       lastCommit = execSync('git log -1 --format=%H', { cwd: safePath, encoding: 'utf-8' }).trim();\n> 1092|       lastCommitMessage = execSync('git log -1 --format=%s', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1093|       const timeStr = execSync('git log -1 --format=%ct', { cwd: safePath, encoding: 'utf-8' }).trim();",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1093,
      "lineEnd": 1093,
      "columnStart": 22,
      "columnEnd": 30,
      "codeSnippet": "  1092|       lastCommitMessage = execSync('git log -1 --format=%s', { cwd: safePath, encoding: 'utf-8' }).trim();\n> 1093|       const timeStr = execSync('git log -1 --format=%ct', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1094|       lastCommitTime = parseInt(timeStr) * 1000;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1099,
      "lineEnd": 1099,
      "columnStart": 21,
      "columnEnd": 29,
      "codeSnippet": "  1098|     try {\n> 1099|       const status = execSync('git status --porcelain', { cwd: safePath, encoding: 'utf-8' });\n  1100|       uncommittedChanges = status.split('\\n').filter(Boolean).length;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1106,
      "lineEnd": 1106,
      "columnStart": 22,
      "columnEnd": 30,
      "codeSnippet": "  1105|     try {\n> 1106|       const commits = execSync('git log -10 --format=%s', { cwd: safePath, encoding: 'utf-8' });\n  1107|       recentCommits = commits.split('\\n').filter(Boolean);",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "command-injection",
      "categoryName": "Command Injection",
      "domain": "security",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/auth.ts",
      "lineStart": 315,
      "lineEnd": 315,
      "columnStart": 4,
      "columnEnd": 23,
      "codeSnippet": "   314|                     process.platform === 'win32' ? 'start' : 'xdg-open';\n>  315|     exec(`${openCmd} ${flow.verificationUri}`);\n   316|   } catch {",
      "patternId": "ts-child-process-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "command-injection",
      "categoryName": "Command Injection",
      "domain": "security",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/scope.ts",
      "lineStart": 226,
      "lineEnd": 226,
      "columnStart": 27,
      "columnEnd": 66,
      "codeSnippet": "   225|     if (firstCommit) {\n>  226|       const filesAtStart = execSync(`git ls-tree -r --name-only ${firstCommit}`, { cwd: projectPath, encoding: 'utf8' })\n   227|         .split('\\n')",
      "patternId": "ts-execsync",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "cpu-spin",
      "categoryName": "CPU Spin and Busy Waiting",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "high",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tui.ts",
      "lineStart": 1235,
      "lineEnd": 1240,
      "columnStart": 27,
      "columnEnd": 321,
      "codeSnippet": "  1234|   // Watch for activity updates (poll tracker every 5s)\n> 1235|   const activityInterval = setInterval(async () => {\n> 1236|     const newSummary = getActivitySummary(projectPath);\n> 1237|     if (newSummary !== tuiState.activitySummary) {\n> 1238|       tuiState.activitySummary = newSummary;",
      "patternId": "ts-setinterval-fast",
      "patternType": "regex",
      "priorityScore": 9
    },
    {
      "categoryId": "dependency-risks",
      "categoryName": "Dependency Risks (Slopsquatting)",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/monitoring.ts",
      "lineStart": 67,
      "lineEnd": 67,
      "columnStart": 4,
      "columnEnd": 25,
      "codeSnippet": "    66|     // eslint-disable-next-line @typescript-eslint/no-require-imports\n>   67|     import('@sentry/node' as string).then((Sentry: unknown) => {\n    68|       const S = Sentry as { ",
      "patternId": "npm-import",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "dependency-risks",
      "categoryName": "Dependency Risks (Slopsquatting)",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/monitoring.ts",
      "lineStart": 175,
      "lineEnd": 175,
      "columnStart": 4,
      "columnEnd": 31,
      "codeSnippet": "   174|     // Dynamic import to avoid requiring OTel as a dependency\n>  175|     import('@opentelemetry/api' as string).then((api: unknown) => {\n   176|       const otelApi = api as {",
      "patternId": "npm-import",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "dependency-risks",
      "categoryName": "Dependency Risks (Slopsquatting)",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/pilot.ts",
      "lineStart": 574,
      "lineEnd": 574,
      "columnStart": 24,
      "columnEnd": 48,
      "codeSnippet": "   573|     try {\n>  574|       const mod = await import('qrcode-terminal');\n   575|       // Handle both ESM default export and CommonJS module.exports",
      "patternId": "npm-import",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "hardcoded-secrets",
      "categoryName": "Hardcoded Secrets",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/state/phase.ts",
      "lineStart": 437,
      "lineEnd": 437,
      "columnStart": 6,
      "columnEnd": 21,
      "codeSnippet": "   436|   'api': [\n>  437|     { key: 'ANNOUNCE', name: 'Announce', action: 'Post to API-focused communities', detail: 'Dev.to, relevant Discord servers, Twitter API community' },\n   438|     { key: 'EXAMPLE', name: 'Example', action: 'Create copy-paste code snippets', detail: 'curl + JS + Python examples - reduce friction to first call' },",
      "patternId": "ts-secret-env-bypass",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "memory-leak",
      "categoryName": "Memory Leak",
      "domain": "resource",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tui-lite.ts",
      "lineStart": 216,
      "lineEnd": 216,
      "columnStart": 19,
      "columnEnd": 31,
      "codeSnippet": "   215|   // Also poll every 5 seconds as backup\n>  216|   const interval = setInterval(render, 5000);\n   217|   ",
      "patternId": "ts-closure-capture",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "memory-leak",
      "categoryName": "Memory Leak",
      "domain": "resource",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tui.ts",
      "lineStart": 1235,
      "lineEnd": 1235,
      "columnStart": 27,
      "columnEnd": 39,
      "codeSnippet": "  1234|   // Watch for activity updates (poll tracker every 5s)\n> 1235|   const activityInterval = setInterval(async () => {\n  1236|     const newSummary = getActivitySummary(projectPath);",
      "patternId": "ts-closure-capture",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "timeout-missing",
      "categoryName": "Missing Timeout",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/credentials/route.ts",
      "lineStart": 23,
      "lineEnd": 23,
      "columnStart": 25,
      "columnEnd": 37,
      "codeSnippet": "    22|   // Verify the GitHub access token\n>   23|   const githubResponse = await fetch('https://api.github.com/user', {\n    24|     headers: {",
      "patternId": "ts-fetch-no-timeout",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "timeout-missing",
      "categoryName": "Missing Timeout",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/pilot-session/[sessionId]/route.ts",
      "lineStart": 72,
      "lineEnd": 72,
      "columnStart": 25,
      "columnEnd": 37,
      "codeSnippet": "    71|   // Verify GitHub token\n>   72|   const githubResponse = await fetch('https://api.github.com/user', {\n    73|     headers: {",
      "patternId": "ts-fetch-no-timeout",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "timeout-missing",
      "categoryName": "Missing Timeout",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/pilot-session/route.ts",
      "lineStart": 25,
      "lineEnd": 25,
      "columnStart": 27,
      "columnEnd": 39,
      "codeSnippet": "    24|     // Verify GitHub token\n>   25|     const githubResponse = await fetch('https://api.github.com/user', {\n    26|       headers: {",
      "patternId": "ts-fetch-no-timeout",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "network-timeout",
      "categoryName": "Network Timeout Handling",
      "domain": "reliability",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/credentials/route.ts",
      "lineStart": 23,
      "lineEnd": 28,
      "columnStart": 31,
      "columnEnd": 197,
      "codeSnippet": "    22|   // Verify the GitHub access token\n>   23|   const githubResponse = await fetch('https://api.github.com/user', {\n>   24|     headers: {\n>   25|       'Authorization': `Bearer ${githubAccessToken}`,\n>   26|       'Accept': 'application/vnd.github+json',",
      "patternId": "ts-fetch-no-signal",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "network-timeout",
      "categoryName": "Network Timeout Handling",
      "domain": "reliability",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/pilot-session/[sessionId]/route.ts",
      "lineStart": 72,
      "lineEnd": 77,
      "columnStart": 31,
      "columnEnd": 185,
      "codeSnippet": "    71|   // Verify GitHub token\n>   72|   const githubResponse = await fetch('https://api.github.com/user', {\n>   73|     headers: {\n>   74|       'Authorization': `Bearer ${token}`,\n>   75|       'Accept': 'application/vnd.github+json',",
      "patternId": "ts-fetch-no-signal",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "network-timeout",
      "categoryName": "Network Timeout Handling",
      "domain": "reliability",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/pilot-session/route.ts",
      "lineStart": 25,
      "lineEnd": 30,
      "columnStart": 33,
      "columnEnd": 211,
      "codeSnippet": "    24|     // Verify GitHub token\n>   25|     const githubResponse = await fetch('https://api.github.com/user', {\n>   26|       headers: {\n>   27|         'Authorization': `Bearer ${github_access_token}`,\n>   28|         'Accept': 'application/vnd.github+json',",
      "patternId": "ts-fetch-no-signal",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/credentials/route.ts",
      "lineStart": 46,
      "lineEnd": 46,
      "columnStart": 4,
      "columnEnd": 41,
      "codeSnippet": "    45|     // Check if user has a database\n>   46|     if (!user.db_url || !user.db_token) {\n    47|       // Provision a new database",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/lib/db.ts",
      "lineStart": 7,
      "lineEnd": 7,
      "columnStart": 2,
      "columnEnd": 23,
      "codeSnippet": "     6| function getMasterClient(): Client {\n>    7|   if (!_masterClient) {\n     8|     const url = process.env.TURSO_DATABASE_URL",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/lib/db.ts",
      "lineStart": 28,
      "lineEnd": 28,
      "columnStart": 2,
      "columnEnd": 30,
      "codeSnippet": "    27|   const key = dbUrl\n>   28|   if (!userClients.has(key)) {\n    29|     userClients.set(key, createClient({",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/atomic-state.ts",
      "lineStart": 119,
      "lineEnd": 119,
      "columnStart": 2,
      "columnEnd": 30,
      "codeSnippet": "   118| ): T {\n>  119|   if (!existsSync(filePath)) {\n   120|     const state = defaultState();",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/atomic-state.ts",
      "lineStart": 161,
      "lineEnd": 161,
      "columnStart": 2,
      "columnEnd": 25,
      "codeSnippet": "   160|   const dir = dirname(filePath);\n>  161|   if (!existsSync(dir)) {\n   162|     mkdirSync(dir, { recursive: true });",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/atomic-state.ts",
      "lineStart": 248,
      "lineEnd": 248,
      "columnStart": 2,
      "columnEnd": 25,
      "codeSnippet": "   247|   const dir = dirname(filePath);\n>  248|   if (!existsSync(dir)) {\n   249|     mkdirSync(dir, { recursive: true });",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/journal.ts",
      "lineStart": 66,
      "lineEnd": 66,
      "columnStart": 2,
      "columnEnd": 25,
      "codeSnippet": "    65|   const dir = getJournalDir(projectPath);\n>   66|   if (!existsSync(dir)) {\n    67|     mkdirSync(dir, { recursive: true });",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/phase.ts",
      "lineStart": 44,
      "lineEnd": 44,
      "columnStart": 2,
      "columnEnd": 30,
      "codeSnippet": "    43|   // Create docs folder\n>   44|   if (!existsSync(docsPath)) {\n    45|     mkdirSync(docsPath, { recursive: true });",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 130,
      "lineEnd": 130,
      "columnStart": 2,
      "columnEnd": 25,
      "codeSnippet": "   129|   const dir = join(projectPath, MIDAS_DIR);\n>  130|   if (!existsSync(dir)) {\n   131|     mkdirSync(dir, { recursive: true });",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "race-condition",
      "categoryName": "Race Condition",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 267,
      "lineEnd": 267,
      "columnStart": 2,
      "columnEnd": 29,
      "codeSnippet": "   266|   const pkgPath = join(safePath, 'package.json');\n>  267|   if (!existsSync(pkgPath)) {\n   268|     return gates;",
      "patternId": "ts-check-then-act",
      "patternType": "regex",
      "priorityScore": 8.399999999999999
    },
    {
      "categoryId": "connection-failure",
      "categoryName": "Connection Failure Handling",
      "domain": "reliability",
      "level": "integration",
      "priority": "P0",
      "severity": "high",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/credentials/route.ts",
      "lineStart": 23,
      "lineEnd": 28,
      "columnStart": 25,
      "columnEnd": 197,
      "codeSnippet": "    22|   // Verify the GitHub access token\n>   23|   const githubResponse = await fetch('https://api.github.com/user', {\n>   24|     headers: {\n>   25|       'Authorization': `Bearer ${githubAccessToken}`,\n>   26|       'Accept': 'application/vnd.github+json',",
      "patternId": "ts-fetch-no-catch",
      "patternType": "regex",
      "priorityScore": 6.299999999999999
    },
    {
      "categoryId": "connection-failure",
      "categoryName": "Connection Failure Handling",
      "domain": "reliability",
      "level": "integration",
      "priority": "P0",
      "severity": "high",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/pilot-session/[sessionId]/route.ts",
      "lineStart": 72,
      "lineEnd": 77,
      "columnStart": 25,
      "columnEnd": 185,
      "codeSnippet": "    71|   // Verify GitHub token\n>   72|   const githubResponse = await fetch('https://api.github.com/user', {\n>   73|     headers: {\n>   74|       'Authorization': `Bearer ${token}`,\n>   75|       'Accept': 'application/vnd.github+json',",
      "patternId": "ts-fetch-no-catch",
      "patternType": "regex",
      "priorityScore": 6.299999999999999
    },
    {
      "categoryId": "connection-failure",
      "categoryName": "Connection Failure Handling",
      "domain": "reliability",
      "level": "integration",
      "priority": "P0",
      "severity": "high",
      "confidence": "medium",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/app/api/pilot-session/route.ts",
      "lineStart": 25,
      "lineEnd": 30,
      "columnStart": 27,
      "columnEnd": 211,
      "codeSnippet": "    24|     // Verify GitHub token\n>   25|     const githubResponse = await fetch('https://api.github.com/user', {\n>   26|       headers: {\n>   27|         'Authorization': `Bearer ${github_access_token}`,\n>   28|         'Accept': 'application/vnd.github+json',",
      "patternId": "ts-fetch-no-catch",
      "patternType": "regex",
      "priorityScore": 6.299999999999999
    }
  ],
  "categoriesScanned": [
    "auth-failures",
    "blocking-io",
    "command-injection",
    "connection-pool-exhaustion",
    "xss",
    "data-race",
    "deadlock",
    "dependency-risks",
    "hardcoded-secrets",
    "injection-fuzzing",
    "deserialization",
    "ldap-injection",
    "memory-leak",
    "idempotency-missing",
    "timeout-missing",
    "network-partition",
    "network-timeout",
    "path-traversal",
    "race-condition",
    "retry-storm",
    "ssrf",
    "sql-injection",
    "thundering-herd",
    "file-upload",
    "xxe",
    "boundary-testing",
    "connection-failure",
    "cpu-spin",
    "csrf",
    "data-truncation",
    "data-validation",
    "file-handle-leak",
    "high-latency",
    "memory-bloat",
    "null-undefined",
    "null-handling",
    "packet-loss",
    "precision-loss",
    "thread-safety",
    "bulk-operation",
    "encoding-mismatch",
    "data-exposure",
    "rate-limiting",
    "schema-migration",
    "timing-attack"
  ],
  "version": 1
}