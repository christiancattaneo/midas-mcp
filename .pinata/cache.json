{
  "timestamp": "2026-02-03T05:53:27.159Z",
  "targetDirectory": "/Users/christiancattaneo/Projects/midas-mcp",
  "score": 0,
  "grade": "F",
  "totalGaps": 55,
  "gaps": [
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/cli.ts",
      "lineStart": 3,
      "lineEnd": 3,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "     2| import { join } from 'path';\n>    3| import { execSync } from 'child_process';\n     4| import { loadState, setPhase, type Phase } from './state/phase.js';",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/cli.ts",
      "lineStart": 264,
      "lineEnd": 264,
      "columnStart": 21,
      "columnEnd": 29,
      "codeSnippet": "   263|       try {\n>  264|         const tags = execSync('git tag -l \"v*\"', { encoding: 'utf-8', cwd });\n   265|         if (tags.trim()) {",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/cursor.ts",
      "lineStart": 4,
      "lineEnd": 4,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "     3| import { homedir, platform } from 'os';\n>    4| import { execSync } from 'child_process';\n     5| import { logger } from './logger.js';",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/cursor.ts",
      "lineStart": 139,
      "lineEnd": 139,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "   138|   try {\n>  139|     const result = execSync(\n   140|       `sqlite3 \"${dbPath}\" \"${query}\"`,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/cleanup.ts",
      "lineStart": 4,
      "lineEnd": 4,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "     3| import { join, relative } from 'path';\n>    4| import { execSync } from 'child_process';\n     5| import { sanitizePath, isShellSafe } from '../security.js';",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/cleanup.ts",
      "lineStart": 169,
      "lineEnd": 169,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "   168|     // Get commit counts per file (last 100 commits for performance)\n>  169|     const output = execSync(\n   170|       'git log --name-only --pretty=format: -100 | sort | uniq -c | sort -rn | head -50',",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/completeness.ts",
      "lineStart": 12,
      "lineEnd": 12,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "    11| import { sanitizePath } from '../security.js';\n>   12| import { execSync } from 'child_process';\n    13| ",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/completeness.ts",
      "lineStart": 231,
      "lineEnd": 231,
      "columnStart": 18,
      "columnEnd": 26,
      "codeSnippet": "   230|   try {\n>  231|     const audit = execSync('npm audit --json 2>/dev/null || echo \"{}\"', {\n   232|       cwd: projectPath,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 11,
      "lineEnd": 11,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "    10| import { join } from 'path';\n>   11| import { execSync } from 'child_process';\n    12| import { sanitizePath } from '../security.js';",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 124,
      "lineEnd": 124,
      "columnStart": 4,
      "columnEnd": 12,
      "codeSnippet": "   123|   try {\n>  124|     execSync('npm run build --dry-run 2>&1 || npm run build', { \n   125|       cwd: projectPath, ",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 137,
      "lineEnd": 137,
      "columnStart": 4,
      "columnEnd": 12,
      "codeSnippet": "   136|   try {\n>  137|     execSync('npm test 2>&1 || true', { \n   138|       cwd: projectPath, ",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 150,
      "lineEnd": 150,
      "columnStart": 4,
      "columnEnd": 12,
      "codeSnippet": "   149|   try {\n>  150|     execSync('npm run lint 2>&1 || true', {\n   151|       cwd: projectPath,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 163,
      "lineEnd": 163,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "   162|   try {\n>  163|     const status = execSync('git status --porcelain', { \n   164|       cwd: projectPath, ",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 183,
      "lineEnd": 183,
      "columnStart": 18,
      "columnEnd": 26,
      "codeSnippet": "   182|   try {\n>  183|     const audit = execSync('npm audit --json 2>&1 || echo \"{}\"', {\n   184|       cwd: projectPath,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 256,
      "lineEnd": 256,
      "columnStart": 21,
      "columnEnd": 29,
      "codeSnippet": "   255|       try {\n>  256|         const tags = execSync('git tag --sort=-version:refname', {\n   257|           cwd: projectPath,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/grow.ts",
      "lineStart": 270,
      "lineEnd": 270,
      "columnStart": 16,
      "columnEnd": 24,
      "codeSnippet": "   269|     const range = from ? `${from}..${to}` : to;\n>  270|     const log = execSync(\n   271|       `git log ${range} --pretty=format:\"%H|%s|%ai\" --no-merges`,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/scope.ts",
      "lineStart": 4,
      "lineEnd": 4,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "     3| import { join, relative } from 'path';\n>    4| import { execSync } from 'child_process';\n     5| import { logger } from '../logger.js';",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/scope.ts",
      "lineStart": 224,
      "lineEnd": 224,
      "columnStart": 24,
      "columnEnd": 32,
      "codeSnippet": "   223|   try {\n>  224|     const firstCommit = execSync('git rev-list --max-parents=0 HEAD', { cwd: projectPath, encoding: 'utf8' }).trim();\n   225|     if (firstCommit) {",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/scope.ts",
      "lineStart": 226,
      "lineEnd": 226,
      "columnStart": 27,
      "columnEnd": 35,
      "codeSnippet": "   225|     if (firstCommit) {\n>  226|       const filesAtStart = execSync(`git ls-tree -r --name-only ${firstCommit}`, { cwd: projectPath, encoding: 'utf8' })\n   227|         .split('\\n')",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/validate.ts",
      "lineStart": 11,
      "lineEnd": 11,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "    10| import { join } from 'path';\n>   11| import { execSync } from 'child_process';\n    12| import { sanitizePath } from '../security.js';",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/validate.ts",
      "lineStart": 69,
      "lineEnd": 69,
      "columnStart": 4,
      "columnEnd": 12,
      "codeSnippet": "    68|   try {\n>   69|     execSync(command, {\n    70|       cwd,",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 141,
      "lineEnd": 141,
      "columnStart": 14,
      "columnEnd": 22,
      "codeSnippet": "   140|   { pattern: /exec\\s*\\(\\s*`[^`]*\\$\\{(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'exec() with template literal injection' },\n>  141|   { pattern: /execSync\\s*\\(\\s*['\"`].*\\+\\s*(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with user input' },\n   142|   { pattern: /execSync\\s*\\(\\s*`[^`]*\\$\\{(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with template literal' },",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 141,
      "lineEnd": 141,
      "columnStart": 98,
      "columnEnd": 106,
      "codeSnippet": "   140|   { pattern: /exec\\s*\\(\\s*`[^`]*\\$\\{(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'exec() with template literal injection' },\n>  141|   { pattern: /execSync\\s*\\(\\s*['\"`].*\\+\\s*(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with user input' },\n   142|   { pattern: /execSync\\s*\\(\\s*`[^`]*\\$\\{(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with template literal' },",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 142,
      "lineEnd": 142,
      "columnStart": 14,
      "columnEnd": 22,
      "codeSnippet": "   141|   { pattern: /execSync\\s*\\(\\s*['\"`].*\\+\\s*(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with user input' },\n>  142|   { pattern: /execSync\\s*\\(\\s*`[^`]*\\$\\{(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with template literal' },\n   143|   // spawn with shell",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 142,
      "lineEnd": 142,
      "columnStart": 96,
      "columnEnd": 104,
      "codeSnippet": "   141|   { pattern: /execSync\\s*\\(\\s*['\"`].*\\+\\s*(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with user input' },\n>  142|   { pattern: /execSync\\s*\\(\\s*`[^`]*\\$\\{(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'execSync() with template literal' },\n   143|   // spawn with shell",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 3,
      "lineEnd": 3,
      "columnStart": 9,
      "columnEnd": 17,
      "codeSnippet": "     2| import { join, relative } from 'path';\n>    3| import { execSync } from 'child_process';\n     4| import writeFileAtomic from 'write-file-atomic';",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 281,
      "lineEnd": 281,
      "columnStart": 6,
      "columnEnd": 14,
      "codeSnippet": "   280|     try {\n>  281|       execSync('npm run build 2>&1', { cwd: safePath, encoding: 'utf-8', timeout: 60000 });\n   282|       gates.compiles = true;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 294,
      "lineEnd": 294,
      "columnStart": 6,
      "columnEnd": 14,
      "codeSnippet": "   293|     try {\n>  294|       execSync('npm test 2>&1', { cwd: safePath, encoding: 'utf-8', timeout: 120000 });\n   295|       gates.testsPass = true;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 311,
      "lineEnd": 311,
      "columnStart": 6,
      "columnEnd": 14,
      "codeSnippet": "   310|     try {\n>  311|       execSync('npm run lint 2>&1', { cwd: safePath, encoding: 'utf-8', timeout: 30000 });\n   312|       gates.lintsPass = true;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1084,
      "lineEnd": 1084,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "  1083|   try {\n> 1084|     const branch = execSync('git branch --show-current', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1085|     ",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1091,
      "lineEnd": 1091,
      "columnStart": 19,
      "columnEnd": 27,
      "codeSnippet": "  1090|     try {\n> 1091|       lastCommit = execSync('git log -1 --format=%H', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1092|       lastCommitMessage = execSync('git log -1 --format=%s', { cwd: safePath, encoding: 'utf-8' }).trim();",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1092,
      "lineEnd": 1092,
      "columnStart": 26,
      "columnEnd": 34,
      "codeSnippet": "  1091|       lastCommit = execSync('git log -1 --format=%H', { cwd: safePath, encoding: 'utf-8' }).trim();\n> 1092|       lastCommitMessage = execSync('git log -1 --format=%s', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1093|       const timeStr = execSync('git log -1 --format=%ct', { cwd: safePath, encoding: 'utf-8' }).trim();",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1093,
      "lineEnd": 1093,
      "columnStart": 22,
      "columnEnd": 30,
      "codeSnippet": "  1092|       lastCommitMessage = execSync('git log -1 --format=%s', { cwd: safePath, encoding: 'utf-8' }).trim();\n> 1093|       const timeStr = execSync('git log -1 --format=%ct', { cwd: safePath, encoding: 'utf-8' }).trim();\n  1094|       lastCommitTime = parseInt(timeStr) * 1000;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1099,
      "lineEnd": 1099,
      "columnStart": 21,
      "columnEnd": 29,
      "codeSnippet": "  1098|     try {\n> 1099|       const status = execSync('git status --porcelain', { cwd: safePath, encoding: 'utf-8' });\n  1100|       uncommittedChanges = status.split('\\n').filter(Boolean).length;",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tracker.ts",
      "lineStart": 1106,
      "lineEnd": 1106,
      "columnStart": 22,
      "columnEnd": 30,
      "codeSnippet": "  1105|     try {\n> 1106|       const commits = execSync('git log -10 --format=%s', { cwd: safePath, encoding: 'utf-8' });\n  1107|       recentCommits = commits.split('\\n').filter(Boolean);",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "blocking-io",
      "categoryName": "Blocking I/O in Async Context",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tui.ts",
      "lineStart": 993,
      "lineEnd": 993,
      "columnStart": 61,
      "columnEnd": 69,
      "codeSnippet": "   992|       \n>  993|       // NOTE: Removed sync gate verification here - it used execSync which blocked\n   994|       // the event loop and froze the spinner. Gates are run on-demand via 'g' key.",
      "patternId": "ts-sync-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "command-injection",
      "categoryName": "Command Injection",
      "domain": "security",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/auth.ts",
      "lineStart": 315,
      "lineEnd": 315,
      "columnStart": 4,
      "columnEnd": 23,
      "codeSnippet": "   314|                     process.platform === 'win32' ? 'start' : 'xdg-open';\n>  315|     exec(`${openCmd} ${flow.verificationUri}`);\n   316|   } catch {",
      "patternId": "ts-child-process-exec",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "command-injection",
      "categoryName": "Command Injection",
      "domain": "security",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/scope.ts",
      "lineStart": 226,
      "lineEnd": 226,
      "columnStart": 27,
      "columnEnd": 66,
      "codeSnippet": "   225|     if (firstCommit) {\n>  226|       const filesAtStart = execSync(`git ls-tree -r --name-only ${firstCommit}`, { cwd: projectPath, encoding: 'utf8' })\n   227|         .split('\\n')",
      "patternId": "ts-execsync",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "command-injection",
      "categoryName": "Command Injection",
      "domain": "security",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 145,
      "lineEnd": 145,
      "columnStart": 61,
      "columnEnd": 85,
      "codeSnippet": "   144|   { pattern: /spawn\\s*\\(\\s*['\"](?:sh|bash|cmd)['\"]/gi, description: 'spawn() with shell - potential injection vector' },\n>  145|   { pattern: /spawn\\s*\\([^)]*shell:\\s*true/gi, description: 'spawn() with shell: true' },\n   146|   // child_process with user input",
      "patternId": "ts-child-process-spawn-shell",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "xss",
      "categoryName": "Cross-Site Scripting (XSS)",
      "domain": "security",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 161,
      "lineEnd": 161,
      "columnStart": 52,
      "columnEnd": 67,
      "codeSnippet": "   160|   // document.write\n>  161|   { pattern: /document\\.write\\s*\\(/g, description: 'document.write() - XSS and performance issues', severity: 'medium' },\n   162|   // eval",
      "patternId": "ts-document-write",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "xss",
      "categoryName": "Cross-Site Scripting (XSS)",
      "domain": "security",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 163,
      "lineEnd": 163,
      "columnStart": 82,
      "columnEnd": 87,
      "codeSnippet": "   162|   // eval\n>  163|   { pattern: /eval\\s*\\(\\s*(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'eval() with user input - critical XSS/RCE', severity: 'critical' },\n   164| ];",
      "patternId": "ts-eval-user-input",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "deadlock",
      "categoryName": "Deadlock",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/completeness.ts",
      "lineStart": 963,
      "lineEnd": 963,
      "columnStart": 32,
      "columnEnd": 79,
      "codeSnippet": "   962| \n>  963|           if (content.includes('transaction') || content.includes('$transaction')) {\n   964|             score += 20;",
      "patternId": "ts-database-transaction",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "dependency-risks",
      "categoryName": "Dependency Risks (Slopsquatting)",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 473,
      "lineEnd": 473,
      "columnStart": 16,
      "columnEnd": 22,
      "codeSnippet": "   472|   const knownPackages: Record<string, string[]> = {\n>  473|     'lodash': ['lodahs', 'lodasch', 'loadash', 'lodsh'],\n   474|     'express': ['expresss', 'expres', 'exprss'],",
      "patternId": "lodash-typosquat",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "dependency-risks",
      "categoryName": "Dependency Risks (Slopsquatting)",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 473,
      "lineEnd": 473,
      "columnStart": 48,
      "columnEnd": 53,
      "codeSnippet": "   472|   const knownPackages: Record<string, string[]> = {\n>  473|     'lodash': ['lodahs', 'lodasch', 'loadash', 'lodsh'],\n   474|     'express': ['expresss', 'expres', 'exprss'],",
      "patternId": "lodash-typosquat",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "dependency-risks",
      "categoryName": "Dependency Risks (Slopsquatting)",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 474,
      "lineEnd": 474,
      "columnStart": 17,
      "columnEnd": 25,
      "codeSnippet": "   473|     'lodash': ['lodahs', 'lodasch', 'loadash', 'lodsh'],\n>  474|     'express': ['expresss', 'expres', 'exprss'],\n   475|     'react': ['reacts', 'reactt', 'raect'],",
      "patternId": "express-typosquat",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "dependency-risks",
      "categoryName": "Dependency Risks (Slopsquatting)",
      "domain": "security",
      "level": "unit",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 474,
      "lineEnd": 474,
      "columnStart": 29,
      "columnEnd": 35,
      "codeSnippet": "   473|     'lodash': ['lodahs', 'lodasch', 'loadash', 'lodsh'],\n>  474|     'express': ['expresss', 'expres', 'exprss'],\n   475|     'react': ['reacts', 'reactt', 'raect'],",
      "patternId": "express-typosquat",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "injection-fuzzing",
      "categoryName": "Injection and Fuzzing",
      "domain": "input",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/vuln-scan.ts",
      "lineStart": 163,
      "lineEnd": 163,
      "columnStart": 82,
      "columnEnd": 87,
      "codeSnippet": "   162|   // eval\n>  163|   { pattern: /eval\\s*\\(\\s*(?:req\\.|params\\.|query\\.|input|user)/gi, description: 'eval() with user input - critical XSS/RCE', severity: 'critical' },\n   164| ];",
      "patternId": "ts-eval-input",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "retry-storm",
      "categoryName": "Retry Storm",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/pilot.ts",
      "lineStart": 338,
      "lineEnd": 339,
      "columnStart": 6,
      "columnEnd": 58,
      "codeSnippet": "   337|       }\n>  338|     } catch (err) {\n>  339|       // Network error, wait and retry\n   340|       console.log(`  âš  Poll error: ${err instanceof Error ? err.message : 'unknown'}`);",
      "patternId": "ts-immediate-retry",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "retry-storm",
      "categoryName": "Retry Storm",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/providers.ts",
      "lineStart": 66,
      "lineEnd": 66,
      "columnStart": 16,
      "columnEnd": 25,
      "codeSnippet": "    65| /**\n>   66|  * Sleep helper for retry backoff\n    67|  */",
      "patternId": "ts-retry-no-backoff",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "retry-storm",
      "categoryName": "Retry Storm",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/providers.ts",
      "lineStart": 112,
      "lineEnd": 125,
      "columnStart": 6,
      "columnEnd": 659,
      "codeSnippet": "   111|       return result;\n>  112|     } catch (error) {\n>  113|       clearTimeout(timeoutId);\n>  114|       lastError = error instanceof Error ? error : new Error(String(error));\n>  115|       ",
      "patternId": "ts-immediate-retry",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "retry-storm",
      "categoryName": "Retry Storm",
      "domain": "concurrency",
      "level": "integration",
      "priority": "P0",
      "severity": "critical",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tools/oneshot.ts",
      "lineStart": 30,
      "lineEnd": 30,
      "columnStart": 13,
      "columnEnd": 27,
      "codeSnippet": "    29| \n>   30| Requirements for this retry:\n    31| - Avoid the approach that caused the above error",
      "patternId": "ts-retry-no-backoff",
      "patternType": "regex",
      "priorityScore": 12
    },
    {
      "categoryId": "cpu-spin",
      "categoryName": "CPU Spin and Busy Waiting",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "high",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/dashboard/components/MatrixRain.tsx",
      "lineStart": 66,
      "lineEnd": 66,
      "columnStart": 21,
      "columnEnd": 42,
      "codeSnippet": "    65| \n>   66|     const interval = setInterval(draw, 50)\n    67| ",
      "patternId": "ts-setinterval-fast",
      "patternType": "regex",
      "priorityScore": 9
    },
    {
      "categoryId": "cpu-spin",
      "categoryName": "CPU Spin and Busy Waiting",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "high",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/providers.ts",
      "lineStart": 606,
      "lineEnd": 606,
      "columnStart": 4,
      "columnEnd": 18,
      "codeSnippet": "   605|   try {\n>  606|     while (true) {\n   607|       const { done, value } = await reader.read();",
      "patternId": "ts-while-true-no-await",
      "patternType": "regex",
      "priorityScore": 9
    },
    {
      "categoryId": "cpu-spin",
      "categoryName": "CPU Spin and Busy Waiting",
      "domain": "performance",
      "level": "unit",
      "priority": "P0",
      "severity": "high",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/tui.ts",
      "lineStart": 1235,
      "lineEnd": 1240,
      "columnStart": 27,
      "columnEnd": 321,
      "codeSnippet": "  1234|   // Watch for activity updates (poll tracker every 5s)\n> 1235|   const activityInterval = setInterval(async () => {\n> 1236|     const newSummary = getActivitySummary(projectPath);\n> 1237|     if (newSummary !== tuiState.activitySummary) {\n> 1238|       tuiState.activitySummary = newSummary;",
      "patternId": "ts-setinterval-fast",
      "patternType": "regex",
      "priorityScore": 9
    },
    {
      "categoryId": "null-undefined",
      "categoryName": "Null and Undefined Handling",
      "domain": "input",
      "level": "unit",
      "priority": "P0",
      "severity": "high",
      "confidence": "high",
      "filePath": "/Users/christiancattaneo/Projects/midas-mcp/src/pilot.ts",
      "lineStart": 491,
      "lineEnd": 491,
      "columnStart": 4,
      "columnEnd": 12,
      "codeSnippet": "   490|   return new Promise((resolve) => {\n>  491|     qrcode!.generate(url, { small: true }, (qr: string) => {\n   492|       const indented = qr.split('\\n').map(line => '  ' + line).join('\\n');",
      "patternId": "ts-non-null-assertion",
      "patternType": "regex",
      "priorityScore": 9
    }
  ],
  "categoriesScanned": [
    "auth-failures",
    "blocking-io",
    "command-injection",
    "connection-pool-exhaustion",
    "xss",
    "data-race",
    "deadlock",
    "dependency-risks",
    "hardcoded-secrets",
    "injection-fuzzing",
    "deserialization",
    "ldap-injection",
    "memory-leak",
    "idempotency-missing",
    "timeout-missing",
    "network-partition",
    "network-timeout",
    "path-traversal",
    "race-condition",
    "retry-storm",
    "ssrf",
    "sql-injection",
    "thundering-herd",
    "file-upload",
    "xxe",
    "boundary-testing",
    "connection-failure",
    "cpu-spin",
    "csrf",
    "data-truncation",
    "data-validation",
    "file-handle-leak",
    "high-latency",
    "memory-bloat",
    "null-undefined",
    "null-handling",
    "packet-loss",
    "precision-loss",
    "thread-safety",
    "bulk-operation",
    "encoding-mismatch",
    "data-exposure",
    "rate-limiting",
    "schema-migration",
    "timing-attack"
  ],
  "version": 1
}